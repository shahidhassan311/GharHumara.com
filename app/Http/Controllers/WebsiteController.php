<?php namespace App\Http\Controllers;use Illuminate\Http\Request;use App\User;use App\Hall;use App\Hall_approved;use App\Hall_images;use App\Booking;use App\Hall_role_type;use App\Service;use App\Theme;use Illuminate\Support\Facades\Auth;use Illuminate\Support\Facades\DB;use Illuminate\Support\Facades\URL;use Validator, Input, Session, Redirect;use Illuminate\Support\Facades\Crypt;class WebsiteController extends Controller{    public function index_page()    {        return view('website.index');    }    public function venue_page()    {        $hall_approved = DB::table('hall_approved as p')->leftjoin('hall_roll_type as hrt', 'p.orignal_hall_id', 'hrt.hall_id')->leftjoin('hall_images as hi', 'hrt.id', 'hi.sec_id')->select('p.*', 'hi.*', 'hrt.*')->where('p.status', "approved")->groupBy('p.orignal_hall_id')->get();        return view('website.venue', compact('hall_approved', 'hall_approved_images'));    }    public function header_page()    {        return view('website.header');    }    public function gallery_page()    {        return view('website.gallery');    }    public function contact_page()    {        return view('website.contact');    }    public function listing_page()    {        return view('website.single-venue');    }    public function about_page()    {        return view('website.about');    }    public function service_page()    {        $vendor_service = DB::table('vendor_service_type')->select('*')->get();        return view('website.services', compact('vendor_service'));    }    public function venue_detail($id)    {        $hall_section = DB::table('hall_roll_type as hr')->leftJoin('hall_approved as h', 'h.id', '=', 'hr.hall_id')->leftJoin('hall_images as hi', 'hi.sec_id', '=', 'hr.id')->select('hr.id as section_id', 'hr.amount', 'hr.detail as detail_section', 'hr.seating', 'hr.section_name', 'h.*', 'hi.images', 'hi.id as images_id')->where('h.id', '!=', '0')->where('h.id', '=', $id)->groupBy('hr.id')->groupBy('hi.sec_id')->get();        $hall_section_id = DB::table('hall_roll_type')->select('*')->where('hall_id', '=', $id)->groupBy('hall_id')->get();        $hall_theme = DB::table('theme as t')->leftjoin('hall_images as hi', 't.id', 'hi.theme_id')->select('t.*', 'hi.images')->where('t.hall_id', '=', $id)->get();        $hall_service = DB::table('service as s')->leftjoin('hall_images as hi', 's.id', 'hi.service_id')->select('s.service_name', 'hi.images', 's.id')->where('s.hall_id', '=', $id)->get();        return view('website.venue_detail', compact('hall_section', 'hall_section_id', 'hall_theme', 'hall_service', 'vendor_service'));    }    public function theme_detail($id)    {        $hall_theme = DB::table('theme')->select('*')->where('id', '=', $id)->get();        $hall_theme_images = '';        foreach ($hall_theme as $hall_themes) {            $theme_id = $hall_themes->id;            $hall_theme_images = DB::table('hall_images')->select('images')->where('theme_id', '=', $theme_id)->get();        }        return view('website.theme_detail', compact('hall_theme', 'hall_theme_images'));    }    public function section_details(Request $request)    {        if ($request->ajax()) {            $section_details = DB::table('hall_roll_type as hr')->leftJoin('hall_approved as h', 'h.id', '=', 'hr.hall_id')->leftJoin('hall_images as hi', 'hi.sec_id', '=', 'hr.id')->select('hr.id as section_id', 'hr.amount', 'hr.detail as detail_section', 'hr.seating', 'hr.section_name', 'h.*', 'hi.images', 'hi.id as images_id')->where('h.id', '=', $request->input('hall_section_id'))->groupBy('hr.hall_id')->get();            $hall_id = '';            foreach ($section_details as $section_detailss) {                $hall_id = $section_detailss->section_id;            }            $sec_img = DB::table('hall_images')->select('images')->where('sec_id', '=', $hall_id)->get();            return response()->json(['options' => $section_details, 'image' => $sec_img]);        } else {            $section_details = DB::table('hall_roll_type as hr')->leftJoin('hall_approved as h', 'h.id', '=', 'hr.hall_id')->leftJoin('hall_images as hi', 'hi.sec_id', '=', 'hr.id')->select('hr.id as section_id', 'hr.amount', 'hr.detail as detail_section', 'hr.seating', 'hr.section_name', 'h.*', 'hi.images', 'hi.id as images_id')->where('h.id', '=', $request->input('hall_section_id'))->groupBy('hr.hall_id')->get();            $hall_id = '';            foreach ($section_details as $section_detailss) {                $hall_id = $section_detailss->section_id;            }            $sec_img = DB::table('hall_images')->select('images')->where('sec_id', '=', $hall_id)->get();            return view('venue_detail', compact('section_details', 'sec_img'))->render();        }    }    public function section_click_where_details(Request $request)    {        if ($request->ajax()) {            $section_details = DB::table('hall_roll_type as hr')->leftJoin('hall_approved as h', 'h.id', '=', 'hr.hall_id')->leftJoin('hall_images as hi', 'hi.sec_id', '=', 'hr.id')->select('hr.id as section_id', 'hr.amount', 'hr.detail as detail_section', 'hr.seating', 'hr.section_name', 'h.*', 'hi.images', 'hi.id as images_id')->where('hr.id', '=', $request->input('hall_section_id'))->groupBy('hr.hall_id')->get();            $hall_id = '';            foreach ($section_details as $section_detailss) {                $hall_id = $section_detailss->section_id;            }            $sec_img = DB::table('hall_images')->select('images')->where('sec_id', '=', $hall_id)->get();            return response()->json(['options' => $section_details, 'image' => $sec_img]);        } else {            $section_details = DB::table('hall_roll_type as hr')->leftJoin('hall_approved as h', 'h.id', '=', 'hr.hall_id')->leftJoin('hall_images as hi', 'hi.sec_id', '=', 'hr.id')->select('hr.id as section_id', 'hr.amount', 'hr.detail as detail_section', 'hr.seating', 'hr.section_name', 'h.*', 'hi.images', 'hi.id as images_id')->where('hr.id', '=', $request->input('hall_section_id'))->groupBy('hr.hall_id')->get();            $hall_id = '';            foreach ($section_details as $section_detailss) {                $hall_id = $section_detailss->section_id;            }            $sec_img = DB::table('hall_images')->select('images')->where('sec_id', '=', $hall_id)->get();            return view('venue_detail', compact('section_details', 'sec_img'))->render();        }    }    public function catering()    {        return view('website.catering');    }    public function catering_detail($id)    {        $catering_deal = [];        $catering_menu = [];        $deal_item = [];        $catering_details = [];        $vendor_service = DB::table('vendor_service as vs')->where('vs.id', $id)->get();        $vendor_catering_deal = DB::table('vendor_catering_deal as vcd')->where('vcd.service_id', $vendor_service[0]->id)->get();        foreach ($vendor_catering_deal as $vendor_catering_deal) {            $vendor_catering_menu = DB::table('vendor_catering_menu as vcm')->where('vcm.vendor_catering_deal_id', $vendor_catering_deal->id)->get();            array_push($catering_deal, $vendor_catering_deal);            foreach ($vendor_catering_menu as $vendor_catering_menu) {                $vendor_deal_item = DB::table('vendor_deal_item as vdi')->where('vdi.menu_id', $vendor_catering_menu->id)->get();                array_push($catering_menu, $vendor_catering_menu);                foreach ($vendor_deal_item as $vendor_deal_item) {                    array_push($deal_item, $vendor_deal_item);                }            }        }        $service_company_name = DB::table('vendor_service')->select('*')->where('id', '=', $id)->get();        $catering_details_view = [            'vendor_service' => $vendor_service,            'catering_deal' => $catering_deal,            'catering_menu' => $catering_menu,            'deal_item' => $deal_item,            'service_company_name' => $service_company_name,            ];        return view('website.catering_detail', compact('catering_details_view'));    }    public function photography()    {        return view('website.photography');    }    public function photography_detail()    {        return view('website.photography_detail');    }    public function transport()    {        return view('website.transport');    }    public function transport_detail()    {        return view('website.transport_detail');    }    public function styling()    {        return view('website.styling');    }    public function styling_detail()    {        return view('website.styling_detail');    }    public function decoration()    {        return view('website.decoration');    }    public function decoration_detail()    {        return view('website.decoration_detail');    }    public function floral()    {        return view('website.floral');    }    public function card()    {        return view('website.card');    }}